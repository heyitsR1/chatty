#include <iostream>
#include <string>
#include <curl/curl.h>
#include <thread>
#include <chrono>
#include "Chatty.h"

// Cool ASCII Art Header
void displayBanner() {
    std::cout << R"(
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣐⣾⣷⣿⠶⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⣼⣿⣿⢻⣿⣯⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢐⡉⠻⣿⣿⣥⠟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⣶⣾⣻⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣸⣿⣿⣦⣤⣤⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⣿⣿⣿⣿⣿⣿⣿⢿⣿⣦⣤⣤⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣶⣿⣿⢿⣿⣿⣿⣿⣿⣻⣿⣿⣟⣆⠂⠈⠉⠛⠳⣦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣶⣿⣿⣿⣿⣿⠿⠛⠛⠋⠉⠉⠉⠉⠛⢻⣿⣿⣷⣶⣦⣄⣻⠉⠹⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⣽⣿⠟⠋⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢉⣍⠙⠾⣿⣿⣶⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⢠⣾⠟⠁⠀⠀⠀⠀⠀⠀⢀⣾⣿⣷⡄⠀⠀⠀⠀⠀⢠⣿⡿⣇⠀⠈⣿⣿⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣯⡿⠂⠀⠀⠀⠀⠀⠀⢸⣿⣟⠛⣧⠀⠀⠀⠀⢀⣿⣿⣧⣿⠀⢀⢿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⡿⣳⠀⠀⠀⠀⠀⠀⢸⣿⣿⠫⡿⠀⠀⠀⠀⠈⢻⣿⢏⡏⠀⣸⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢿⣿⣿⣷⡀⠀⠀⠀⠀⣄⣻⣷⣾⡷⠶⠶⠒⠒⠶⠾⠿⠾⢧⣄⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣷⣤⠀⠀⠀⠀⠀⠀⣠⠀⠀⠀⠀⠀⠀⠀⢠⡀⠀⢀⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣿⣿⣽⠀⠀⠀⠀⠀⠉⠳⢤⣀⠀⠀⠀⣀⡤⠞⠉⠀⠘⡾⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣿⠟⠀⠀⢀⣀⣀⣀⣀⣀⣉⣭⣭⣭⣭⣤⣀⣀⣀⣀⣑⡇⠀⠀⠀⢠⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣤⣾⣷⠾⠟⠛⠛⠛⠋⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠙⠛⠓⠲⣴⣿⠄⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣄⠀⠀⠀⠀⠀⠀⠀  ██████╗██╗  ██╗ █████╗ ████████╗████████╗██╗   ██╗                                                                             
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡴⠞⢻⡄⠂⠀⢠⠀⠀⢀⣀⣠⣤⣤⠤⠤⠖⠒⠒⠒⠒⠢⠤⢤⣴⠃⠘⠃⣾⠇⠀⠀⠀⠀⣦⣠⠤⣶⣶⣸⡀⢹⡄⠀⢀⠐⠒⢠⢀ ██╔════╝██║  ██║██╔══██╗╚══██╔══╝╚══██╔══╝╚██╗ ██╔╝
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡶⠋⠀⠀⠈⢳⡄⠀⠈⣿⣿⣏⣁⡦⠼⠷⠶⠛⠛⠛⠛⠛⠛⠒⡶⠋⡿⠀⠀⣼⣏⣀⣀⣀⣠⣼⣿⠃⣸⣿⡿⠛⠛⠛⠉⣿⣧⣤⣶⣚⣭ ██║     ███████║███████║   ██║      ██║    ╚████╔╝ 
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⣿⣯⣀⣠⡴⠶⠶⣄⣳⡀⠀⢹⡏⠉⠀⠀⠀⠀⠀⠀⣶⠀⠀⠀⠀⠀⣇⣀⡇⠀⠀⣿⢻⡏⢹⣿⢻⣿⣿⠀⣿⣿⠃⠀⠀⠀⠀⣿⠿⣿⣋⣉⣙ ██║     ██╔══██║██╔══██║   ██║      ██║     ╚██╔╝  
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠉⢿⣿⣿⠉⣀⡤⠤⠬⢿⣧⠀⠀⣿⠀⠀⠀⠀⣦⠀⣰⣿⠀⠀⠀⡀⠀⢾⣿⠁⣀⢰⡇⢸⣷⢸⣿⡸⣿⠈⠀⢹⣿⡆⠀⠀⠀⣰⣿⣴⠛⠿⣯⡉ ╚██████╗██║  ██║██║  ██║   ██║      ██║      ██║   
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣨⣿⣧⠞⠁⠀⠀⠀⢸⢿⡟⠀⠘⣇⢹⡀⢰⣿⡄⡟⣿⣰⣇⢸⣇⣶⣿⣿⠀⠉⣿⣇⣘⣟⣀⣻⣇⣿⣟⠀⠀⢿⣿⣶⡴⠿⠿⠛⠙⠢⣤⡼⠃ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝      ╚═╝      ╚═╝ 
⠀⠀⠀⠀⠀⠀⠀⢠⡄⢀⣴⣾⡛⡏⢻⣿⣶⣴⣴⣶⠟⠀⣷⠀⠀⢿⡄⢱⡜⠘⣷⠁⢹⡿⠻⡾⠻⢉⡿⣿⠀⠀⡿⠉⠉⠉⠉⠁⠀⠀⠉⠑⠒⠒⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⢀⣀⣴⣿⣷⢾⣇⢿⣧⠙⢤⣉⣹⡿⠛⠁⠀⠀⠹⡀⠀⢸⡇⠀⠙⠀⠹⠄⠀⠁⠀⠀⠀⢸⣧⣿⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⣿⣿⡟⢿⣿⡈⢿⡧⠛⢤⣤⣿⣿⣿⣦⡀⠀⠀⠀⣷⣤⠈⢧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⡏⠘⠃⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢠⣿⣿⡇⠘⢿⣷⣤⣝⣦⡴⠋⠀⠹⣿⣶⢦⠀⠀⠀⢹⡉⠀⢸⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⡇⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣴⠂⠰⠟⣿⣯⣷⡄⠈⠻⢿⣿⣿⡇⠀⠀⠀⢹⣾⣼⡄⠀⠀⠀⣇⠀⠚⠛⠚⠛⠛⠉⠉⠉⠉⠉⠉⠉⠉⠁⢠⡄⣇⣀⡤⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣉⣷⠦⠀⠘⢿⣿⣿⣦⣄⣀⣩⠿⠃⠀⠀⠀⢀⣿⣿⣃⣀⡀⠀⣿⣴⣀⣤⣶⣒⣶⣶⣶⣄⣠⣤⣤⣤⣶⠾⠷⠛⠿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠻⣤⡴⣦⠀⣤⣤⠀⢻⡟⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢹⣿⣉⠛⠻⢯⣭⣹⡟⠉⠻⣿⣯⠟⢁⡤⠛⢛⣧⠀⠐⣤⣤⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠈⢷⡶⠃⠘⠛⠾⠃⠀⠀⠀⠀⠀⠀⠀⠀⢠⣄⣰⣾⣿⣌⡛⠒⠤⣤⡾⠀⠀⠀⠹⣿⣿⣋⣴⠋⢀⣬⠟⠛⢿⣧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⣿⣿⣿⠷⣀⠙⠳⠶⡾⠇⠀⠀⠀⠀⠙⣿⣟⢁⣴⠟⠁⠀⠀⠀⠛⢿⣦⡀⠀⠀⠀⠀⠀⣀⣠⡴⠶⣦⣤⣀⠀⡀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢷⣿⣿⣻⣿⣿⣄⡈⠉⠒⣾⠇⠀⠀⠀⠀⠀⠀⠈⢻⡟⠁⠀⠀⠀⢀⣴⣺⣽⣾⣇⠀⢀⣠⠶⠋⠉⠀⠀⢈⣩⣿⠿⠛⣿⣷⢀⡄⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⡅⠀⠙⠻⢿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀⢰⣿⡇⢀⠀⢀⣴⣯⠚⠁⠀⠈⢻⣷⠛⠁⠀⠀⠀⣠⡶⠛⠁⢀⣀⣤⣶⣿⣿⠁⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⣾⡟⣿⡿⠻⣶⣄⣀⣰⣯⣾⠏⠀⠀⠀⠀⠀⠀⠀⠀⠙⣿⣿⣿⣿⣟⣅⠀⠀⠀⣰⠏⠁⠀⠀⢀⡴⠛⠁⢀⣤⣾⣿⡟⣧⣰⠟⠁⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⡾⠛⣽⣿⣿⠟⠀⠀⠀⢉⡿⠛⠻⠷⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⠿⢿⣿⣿⣿⣦⡞⠁⠀⠀⢀⡴⠋⠀⣀⡴⣿⣿⠏⠹⣧⣾⠛⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⠃⠀⠙⣿⣷⣶⣤⣠⣴⢿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣿⣿⡟⠀⠀⢀⣴⢿⡀⢠⣾⣿⣷⡆⠑⢦⣰⠟⠁⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⠀⠀⠀⠈⠉⠹⠻⠠⠄⠈⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣿⠁⠀⢠⣾⣷⣆⣽⣿⣿⡌⠙⢧⣤⡿⠋⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣆⣠⣿⢿⣶⣿⠿⣷⡝⣷⡾⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣽⣿⣹⣿⣿⣏⣠⡿⠟⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⢠⣼⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⡿⠟⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢿⡿⣽⣄⠀⠐⠶⣤⣴⣾⣿⣿⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣌⡉⠛⠶⠤⢼⣿⡿⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠓⠒⠶⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣶⣷⣦⡦⣶⡗⢾⢦⢦⣴⡲⣴⣾⢦⡖⣤⡄⢤⡄⠀⣤⢢⣴⣦⣆⣤⡄⠀⠄⢠⣾⣇⣩⠏⣹⢣⡾⣤⣾⣤⠤⣄⠀⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

                                                                                                                                                                                                                   
  👋 Welcome to Chatty - Your friendly AI Chatbot ᕦ(⩾﹏⩽)ᕥ
    )" << std::endl;
}

void loadingEffect() {
    std::string dots = "...";
    for (char dot : dots) {
        std::cout << dot << std::flush;
        std::this_thread::sleep_for(std::chrono::milliseconds(300));
    }
}

int main() {
    curl_global_init(CURL_GLOBAL_ALL);

    displayBanner(); // Show ASCII banner

    std::cout << "\n🔑 Enter your Anthropic API key: ";
    std::string api_key;
    std::getline(std::cin, api_key);

    Chatty chatty(api_key); // Custom chatbot class

    std::cout << "\n🤖 Chatty welcomes you to his world! (Type 'exit' to quit)\n";
    std::string user_input;

    while (true) {
        std::cout << "\n\033[1;32mYou 🡆 \033[0m"; // Green colored input prompt
        std::getline(std::cin, user_input);

        if (user_input == "exit") break;

        std::cout << "\033[1;34mChatty 🡆 \033[0m"; // Blue colored Chatty output
        loadingEffect();
        std::cout << "\n";

        std::string response = chatty.chat(user_input);
        std::cout << response << std::endl;
    }

    std::cout << "\n👋 Goodbye, see you next time!\n";
    curl_global_cleanup();
    return 0;
}
